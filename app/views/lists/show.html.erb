<h2>
  <%= @list.name %> <small><%= @list.store.name %></small>
</h2>

<div class="panel panel-default">
  <div class="panel-heading" id="add-item"><%= t('add_', model: Item.model_name.human) %></div>
  <div class="panel-body" id="add-body" style="display: none;">
    <%= render 'items/form' %>
  </div>
</div>

<div class="table-responsive">
  <table class="table table-hover table-condensed">
    <tbody>
    <tr>
      <th width="55%"><%= Item.human_attribute_name(:product) %></th>
      <th width="15%" class="text-right"><%= Item.human_attribute_name(:price) %></th>
      <th width="10%" class="text-right"><abbr title="<%= Item.human_attribute_name(:amount) %>">[-]</abbr></th>
      <th width="20%" class="text-right"><%= Item.human_attribute_name(:total) %></th>
      <th width="10px"></th>
    </tr>
    <% @items.order('product').each do |p| %>
        <tr>
          <td><%= p.product %></td>
          <%= form_for p do |f| %>
              <td class="text-right">
                <span class="fm-text" id="label_price_<%= p.id %>"><abbr title="<%= t 'click_to_edit' %>"><%= number_to_currency(p.price) %></abbr></span>
                <%= f.number_field :price, :class => 'form-control input-sm', :id => "input_price_#{p.id}", :style => "display: none;" %>
              </td>
              <td class="text-right">
                <span class="fm-text" id="label_amount_<%= p.id %>"><abbr title="<%= t 'click_to_edit' %>"><%= number_with_delimiter(p.amount) %></abbr></span>
                <%= f.number_field :amount, :class => 'form-control input-sm', :id => "input_amount_#{p.id}", :style => "display: none;" %>
              </td>
          <% end %>
          <td class="text-right"><%= number_to_currency(p.total) %></td>
          <td><%= link_to (fa_icon 'trash').to_s, item_path(p), method: :delete, data: {confirm: t(:prompt_to_delete)} %></td>
        </tr>
    <% end %>
    </tbody>
    <tfoot>
    <% if @items.blank? %>
        <tr class="text-center">
          <td colspan="5"><%= t('no_record', model: Item.model_name.human) %></td>
        </tr>
    <% end %>
    </tfoot>
  </table>
</div>

<br class="clearfix">

<% content_for :outcontainer do %>
    <div class="footer-show">
      <div class="container-fluid">
        <%= link_to raw(t('btn_back', model: Item.model_name.human)), lists_path, :class => 'btn btn-default' %>
        <a href="#" id="compare-btn" class="btn btn-default"><%= raw(t('btn_compare'))%></a>
        <h4 class="pull-right"><%= Item.human_attribute_name(:total) %>: <%= number_to_currency(@items.sum(:total)) %></h4>
      </div>
    </div>

    <script type="text/javascript">
      $(document).ready(function () {
        $('#add-item').css('cursor', 'pointer');
        $("#add-item").click(function () {
          $("#add-body").fadeToggle();
        });

        $(".fm-text").click(function () {
          var x = $(this).attr('id').split('_');
          var label = '#label_' + x[1] + '_' + x[2];
          var input = '#input_' + x[1] + '_' + x[2];

          $(label).toggle();
          $(input).toggle();
          $(input).focus();

          var antevalor = $(input).val();

          $(input).blur(function () {
            $(label).toggle();
            $(input).toggle();

            if (antevalor != $(input).val())
              $("#edit_item_" + x[2]).submit();
          });
        });

        $('#compare-btn').on('click', function () {
          var pdf_link = '/compare';
          var iframe = '<iframe id="iframe1" class="iframe" src="' + pdf_link + '"></iframe>';
          $.createModal({
            title: 'comparar',
            message: iframe,
            closeButton: true,
            saveButton: false,
            scrollable: false
          });
          return false;
        });
      });
    </script>
<% end %>